{% extends "wms/main.html" %}
{% load staticfiles %}
{% load i18n %}
{% block title %}<title>Solvo.Web Заказы</title>{% endblock %}
{% block page-header %}Заказы{% endblock %}
{% block table_header %}
    <div class="need_scroll">
        <table id="order_header" class="table table-striped table-hover">
          <thead>
            <tr>
              <th>#</th>
              <th>Код</th>
              <th>Накладная</th>
              <th>Дата отгрузки</th>
              <th>Статус</th>
            </tr>
          </thead>
          <tbody>
            {% for query in available_orders %}
                <tr id="{{ query.id }}">
                  <td>{{ query.id }}</td>
                  <td>{{ query.sdid }}</td>
                  <td>{{ query.display_name }}</td>
                  <td>{{ query.date_to_ship }}</td>
                  <td>{{ query.status }}</td>
                </tr>
            {% endfor %}
          </tbody>
        </table>
    </div>
    <div id="order_detail"></div>
{% endblock %}

<!--body onload="makeTableScroll();">
<div class="scrollingTable">
<table id="order_header" border="1">
    <tr><th>Номер</th><th>Накладная</th><th>Статус</th><th>Владелец</th></tr>
    {% for a in available_orders %}
    <tr id="{{ a.id }}" class="nonSelectedRow {{ a.status }}">
        <td>{{ a.id }}</td>
        <td>{{ a.display_name }}</td>
        <td>{{ a.status }}</td>
        <td>{{ a.holder }}</td>
    </tr>
    {% endfor %}
</table>
</div>
</body-->



{% block script %}
        <script type="text/javascript">
            function makeTableScroll() {
                // Constant retrieved from server-side via JSP
                var maxRows = 20;

                var table = document.getElementById('order_header');
                var wrapper = table.parentNode;
                var rowsInTable = table.rows.length;
                var height = 0;
                if (rowsInTable > maxRows) {
                    for (var i = 0; i < maxRows; i++) {
                        height += table.rows[i].clientHeight;
                    }
                    wrapper.style.height = height + "px";
                }
            }
        </script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function(){
               $('#order_header').on('click', 'tr', function(){
                    $.ajax({url:"/wms/order_detail/",
                        data:{id: $(this).attr("id")},
                        type: "POST",
                        success: function(response) {
                            $("#order_detail").html(response);
                          }
                    });
                })
                /*$( "tr" ).click(function() {
                    $('.SelectedRow').toggleClass("SelectedRow").toggleClass("nonSelectedRow");
                    $(this).toggleClass("nonSelectedRow").toggleClass("SelectedRow");
                });*/
            });
        </script>
{% endblock %}